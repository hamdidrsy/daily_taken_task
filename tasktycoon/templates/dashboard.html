<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaskTycoon - Şirket Paneli</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
    <style>
    .modal-summary .modal-content {
        background: #f8f9fa;
        border-radius: 12px;
        box-shadow: 0 4px 24px rgba(0,0,0,0.15);
    }
    .modal-summary .modal-header {
        background: #0d6efd;
        color: #fff;
        border-bottom: none;
    }
    .modal-summary .modal-footer {
        border-top: none;
    }
    </style>
</head>
<body>
    <nav class="navbar navbar-dark bg-dark fixed-top">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1">
                <i class="fas fa-building"></i> TaskTycoon - Şirket Paneli
            </span>
            <div class="d-flex">
                <span class="badge bg-info me-2">Gün: <span id="current-day">{{ state.current_day }}</span></span>
                <span class="badge bg-warning me-2">Enerji: <span id="energy">{{ state.energy }}</span>/100</span>
            </div>
        </div>
    </nav>

    <div class="container-fluid mt-3">
        <div class="row">
            <!-- Sol Panel - Kaynaklar -->
            <div class="col-md-3">
                <div class="card">
                    <div class="card-header bg-success text-white">
                        <h5><i class="fas fa-coins"></i> Kaynaklar</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-2">
                            <strong>Para:</strong> 
                            <span id="cash" class="text-success" data-bs-toggle="tooltip" title="Şirket kasasındaki toplam para">{{ ":,".format(state.cash) }}</span> TL
                        </div>
                        <div class="mb-2">
                            <strong>Araştırma:</strong> 
                            <span id="research" class="text-info" data-bs-toggle="tooltip" title="Teknoloji puanınız, yeni geliştirmeler için kullanılır">{{ state.research }}</span>
                        </div>
                        <div class="mb-2">
                            <strong>İtibar:</strong> 
                            <span id="reputation" class="text-warning">{{ state.reputation }}</span>
                        </div>
                        <div class="mb-2">
                            <strong>Toplam Çalışan:</strong> 
                            <span id="total-employees" class="text-primary">{{ state.employees|length }}</span>
                        </div>
                    </div>
                </div>

                <!-- Enerji Çubuğu -->
                <div class="card mt-3">
                    <div class="card-body">
                        <span class="form-label">Enerji Durumu</span>
                        <div class="progress">
                            <div id="energy-bar" class="progress-bar bg-warning" role="progressbar" 
                                 style="width: {{ state.energy }}%" 
                                 aria-valuenow="{{ state.energy }}" aria-valuemin="0" aria-valuemax="100">
                                {{ state.energy }}/100
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Orta Panel - Departmanlar -->
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5><i class="fas fa-sitemap"></i> Departmanlar</h5>
                    </div>
                    <div class="card-body">
                        <div class="row" id="departments-container">
                            {% for dept_name, dept_info in state.departments.items() %}
                            <div class="col-md-6 mb-3">
                                <div class="card border-secondary">
                                    <div class="card-body text-center">
                                        <h6 class="card-title">{{ dept_name }}</h6>
                                        <p class="card-text">
                                            <small class="text-muted">
                                                Seviye: {{ dept_info.level }}<br>
                                                Çalışan: {{ dept_info.employees|length }}
                                            </small>
                                        </p>
                                        <button class="btn btn-sm btn-outline-primary" 
                                                onclick="upgradeDepartment('{{ dept_name }}')" data-bs-toggle="tooltip" title="Departmanı geliştirerek daha fazla çalışan ve gelir elde edebilirsin!">
                                            <i class="fas fa-arrow-up"></i> Geliştir
                                        </button>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                        
                        <!-- Yeni Departman Ekleme -->
                        <div class="mt-3">
                            <button class="btn btn-success" onclick="showAddDepartmentModal()" data-bs-toggle="tooltip" title="Yeni bir departman ekle">
                                <i class="fas fa-plus"></i> Yeni Departman
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Görevler -->
                <div class="card mt-3">
                    <div class="card-header bg-info text-white">
                        <h5><i class="fas fa-tasks"></i> Günlük Görevler</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4">
                                <button class="btn btn-primary w-100 mb-2" onclick="performTask('work')" data-bs-toggle="tooltip" title="Çalışarak para kazan, enerji harca">
                                    <i class="fas fa-briefcase"></i><br>
                                    Çalış<br>
                                    <small>(+100 Para, -10 Enerji)</small>
                                </button>
                            </div>
                            <div class="col-md-4">
                                <button class="btn btn-info w-100 mb-2" onclick="performTask('research')" data-bs-toggle="tooltip" title="Araştırma yaparak teknoloji puanı kazan, enerji harca">
                                    <i class="fas fa-flask"></i><br>
                                    Araştır<br>
                                    <small>(+5 Teknoloji, -15 Enerji)</small>
                                </button>
                            </div>
                            <div class="col-md-4">
                                <button class="btn btn-warning w-100 mb-2" onclick="performTask('network')" data-bs-toggle="tooltip" title="Ağ kurarak itibar kazan, enerji harca">
                                    <i class="fas fa-handshake"></i><br>
                                    Ağ Kur<br>
                                    <small>(+3 İtibar, -12 Enerji)</small>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sağ Panel - Çalışanlar ve Kontroller -->
            <div class="col-md-3">
                <div class="card">
                    <div class="card-header bg-secondary text-white">
                        <h5><i class="fas fa-users"></i> Çalışanlar</h5>
                    </div>
                    <div class="card-body" id="employees-container" style="max-height: 300px; overflow-y: auto;">
                        {% for employee in state.employees %}
                        <div class="mb-2 p-2 border rounded">
                            <strong>{{ employee.name }}</strong><br>
                            <small class="text-muted">
                                {{ employee.position }} - {{ employee.department }}<br>
                                Maaş: {{ employee.salary }} TL
                            </small>
                        </div>
                        {% endfor %}
                    </div>
                    <div class="card-footer">
                        <button class="btn btn-success btn-sm w-100" onclick="showHireEmployeeModal()" data-bs-toggle="tooltip" title="Yeni çalışan işe al">
                            <i class="fas fa-user-plus"></i> Çalışan İşe Al
                        </button>
                    </div>
                </div>

                <!-- Gün Kontrolleri -->
                <div class="card mt-3">
                    <div class="card-header bg-danger text-white">
                        <h5><i class="fas fa-calendar-day"></i> Gün Kontrolleri</h5>
                    </div>
                    <div class="card-body">
                        <button class="btn btn-warning w-100 mb-2" onclick="restoreEnergy()" data-bs-toggle="tooltip" title="Enerjini tamamen yenile (ücretli olabilir)">
                            <i class="fas fa-battery-full"></i> Enerji Yenile
                        </button>
                        <button class="btn btn-danger w-100" onclick="endDay()" data-bs-toggle="tooltip" title="Günü bitir ve özet al">
                            <i class="fas fa-moon"></i> Günü Bitir
                        </button>
                    </div>
                </div>

                <!-- Kaydet/Yükle -->
                <div class="card mt-3">
                    <div class="card-body">
                        <button class="btn btn-outline-primary w-100 mb-2" onclick="saveGame()" data-bs-toggle="tooltip" title="Oyun durumunu kaydet">
                            <i class="fas fa-save"></i> Oyunu Kaydet
                        </button>
                        <button class="btn btn-outline-secondary w-100" onclick="loadGame()" data-bs-toggle="tooltip" title="Kayıtlı oyunu yükle">
                            <i class="fas fa-upload"></i> Oyunu Yükle
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- Gün Sonu Özet Modalı -->
    <div class="modal fade modal-summary" id="daySummaryModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Gün Sonu Özeti</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="day-summary-content">
                    <!-- JS ile doldurulacak -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Kapat</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Departman Ekleme Modal -->
    <div class="modal fade" id="addDepartmentModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Yeni Departman Ekle</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="deptName" class="form-label">Departman Adı</label>
                        <input type="text" class="form-control" id="deptName" placeholder="IT, Pazarlama, Satış...">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">İptal</button>
                    <button type="button" class="btn btn-primary" onclick="addDepartment()">Ekle</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Çalışan İşe Alma Modal -->
    <div class="modal fade" id="hireEmployeeModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Yeni Çalışan İşe Al</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="empName" class="form-label">Çalışan Adı</label>
                        <input type="text" class="form-control" id="empName" placeholder="Çalışan adı">
                    </div>
                    <div class="mb-3">
                        <label for="empPosition" class="form-label">Pozisyon</label>
                        <input type="text" class="form-control" id="empPosition" placeholder="Geliştirici, Tasarımcı, Yönetici...">
                    </div>
                    <div class="mb-3">
                        <label for="empDepartment" class="form-label">Departman</label>
                        <select class="form-control" id="empDepartment">
                            {% for dept_name in state.departments.keys() %}
                            <option value="{{ dept_name }}">{{ dept_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">İptal</button>
                    <button type="button" class="btn btn-primary" onclick="hireEmployee()">İşe Al</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
